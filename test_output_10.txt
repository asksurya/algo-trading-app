============================= test session starts ==============================
platform darwin -- Python 3.12.1, pytest-9.0.1, pluggy-1.6.0
rootdir: /Users/ashwin/Desktop/algo-trading-app/backend
configfile: pytest.ini
plugins: anyio-4.11.0, asyncio-1.3.0, cov-7.0.0
asyncio: mode=Mode.AUTO, debug=False, asyncio_default_fixture_loop_scope=None, asyncio_default_test_loop_scope=function
collected 1 item

backend/tests/test_backtesting_e2e.py F                                  [100%]

=================================== FAILURES ===================================
____________________________ test_backtest_e2e_flow ____________________________

client = <httpx.AsyncClient object at 0x11d1e72f0>
auth_headers = {'Authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJjZmQ0NTZlMy1kZDFkLTRhMDUtODQ0Yi1iYjgyOWM4ZDIxNDkiLCJ0eXBlIjoiYWNjZXNzIiwiZXhwIjoxNzY1NDI2OTI1fQ.HNZh9hQhcu_gKXVlhrZAiCUKOZ44zL_SEsrvdEP-4UE'}
mock_market_data_cache = <MagicMock name='MarketDataCacheService()' id='4785886976'>

    @pytest.mark.asyncio
    async def test_backtest_e2e_flow(client, auth_headers, mock_market_data_cache):
        """
        Test the full backtesting flow:
        1. Create a strategy
        2. Create and run a backtest
        3. Verify results
        """
    
        # 1. Create Strategy
        strategy_data = {
            "name": "E2E Test Strategy",
            "description": "Test Strategy",
            "strategy_type": "sma_crossover",
            "parameters": {
                "symbol": "AAPL",
                "short_window": 10,
                "long_window": 20
            }
        }
    
        response = await client.post(
            "/api/v1/strategies",
            json=strategy_data,
            headers=auth_headers
        )
        assert response.status_code == 201
        strategy_id = response.json()["id"]
    
        # 2. Create and Run Backtest
        backtest_data = {
            "strategy_id": strategy_id,
            "name": "E2E Backtest",
            "start_date": "2023-01-01",
            "end_date": "2023-01-31",
            "initial_capital": 10000.0,
            "commission": 0.0,
            "slippage": 0.0
        }
    
        response = await client.post(
            "/api/v1/backtests",
            json=backtest_data,
            headers=auth_headers
        )
    
        assert response.status_code == 201
        data = response.json()
        assert data["success"] is True
>       assert data["data"]["status"] == "completed"
E       AssertionError: assert 'failed' == 'completed'
E         
E         - completed
E         + failed

backend/tests/test_backtesting_e2e.py:76: AssertionError
----------------------------- Captured stdout call -----------------------------
payload from token: {'sub': 'cfd456e3-dd1d-4a05-844b-bb829c8d2149', 'type': 'access', 'exp': 1765426925}
user_id from token: cfd456e3-dd1d-4a05-844b-bb829c8d2149
payload from token: {'sub': 'cfd456e3-dd1d-4a05-844b-bb829c8d2149', 'type': 'access', 'exp': 1765426925}
user_id from token: cfd456e3-dd1d-4a05-844b-bb829c8d2149
DEBUG: Found strategy: <Strategy(id=dfb3aed3-5d28-45a9-94ad-d8364f7868fe, name=E2E Test Strategy, type=sma_crossover)>
------------------------------ Captured log call -------------------------------
WARNING  src.backtesting.backtest_engine:backtest_engine.py:213 No trades to analyze
ERROR    app.backtesting.runner:runner.py:113 Backtest 883083c3-9f7a-41c6-82bb-67b25e575f76 failed: greenlet_spawn has not been called; can't call await_only() here. Was IO attempted in an unexpected place? (Background on this error at: https://sqlalche.me/e/20/xd2s)
Traceback (most recent call last):
  File "/Users/ashwin/.pyenv/versions/3.12.1/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
  File "/Users/ashwin/.pyenv/versions/3.12.1/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/Users/ashwin/.pyenv/versions/3.12.1/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/Users/ashwin/.pyenv/versions/3.12.1/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/Users/ashwin/.pyenv/versions/3.12.1/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 778, in _emit_update_statements
    for (
  File "/Users/ashwin/.pyenv/versions/3.12.1/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 577, in _collect_update_commands
    history = state.manager[propkey].impl.get_history(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ashwin/.pyenv/versions/3.12.1/lib/python3.12/site-packages/sqlalchemy/orm/attributes.py", line 1265, in get_history
    current = self.get(state, dict_, passive=passive)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ashwin/.pyenv/versions/3.12.1/lib/python3.12/site-packages/sqlalchemy/orm/attributes.py", line 1096, in get
    value = self._fire_loader_callables(state, key, passive)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ashwin/.pyenv/versions/3.12.1/lib/python3.12/site-packages/sqlalchemy/orm/attributes.py", line 1126, in _fire_loader_callables
    return state._load_expired(state, passive)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ashwin/.pyenv/versions/3.12.1/lib/python3.12/site-packages/sqlalchemy/orm/state.py", line 803, in _load_expired
    self.manager.expired_attribute_loader(self, toload, passive)
  File "/Users/ashwin/.pyenv/versions/3.12.1/lib/python3.12/site-packages/sqlalchemy/orm/loading.py", line 1674, in load_scalar_attributes
    result = load_on_ident(
             ^^^^^^^^^^^^^^
  File "/Users/ashwin/.pyenv/versions/3.12.1/lib/python3.12/site-packages/sqlalchemy/orm/loading.py", line 510, in load_on_ident
    return load_on_pk_identity(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/ashwin/.pyenv/versions/3.12.1/lib/python3.12/site-packages/sqlalchemy/orm/loading.py", line 695, in load_on_pk_identity
    session.execute(
  File "/Users/ashwin/.pyenv/versions/3.12.1/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2351, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ashwin/.pyenv/versions/3.12.1/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2249, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ashwin/.pyenv/versions/3.12.1/lib/python3.12/site-packages/sqlalchemy/orm/context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/Users/ashwin/.pyenv/versions/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "/Users/ashwin/.pyenv/versions/3.12.1/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ashwin/.pyenv/versions/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ashwin/.pyenv/versions/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ashwin/.pyenv/versions/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/ashwin/.pyenv/versions/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2358, in _handle_dbapi_exception
    raise exc_info[1].with_traceback(exc_info[2])
  File "/Users/ashwin/.pyenv/versions/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/ashwin/.pyenv/versions/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "/Users/ashwin/.pyenv/versions/3.12.1/lib/python3.12/site-packages/sqlalchemy/dialects/sqlite/aiosqlite.py", line 180, in execute
    self._adapt_connection._handle_exception(error)
  File "/Users/ashwin/.pyenv/versions/3.12.1/lib/python3.12/site-packages/sqlalchemy/dialects/sqlite/aiosqlite.py", line 340, in _handle_exception
    raise error
  File "/Users/ashwin/.pyenv/versions/3.12.1/lib/python3.12/site-packages/sqlalchemy/dialects/sqlite/aiosqlite.py", line 157, in execute
    _cursor: AsyncIODBAPICursor = self.await_(self._connection.cursor())  # type: ignore[arg-type] # noqa: E501
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ashwin/.pyenv/versions/3.12.1/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 123, in await_only
    raise exc.MissingGreenlet(
sqlalchemy.exc.MissingGreenlet: greenlet_spawn has not been called; can't call await_only() here. Was IO attempted in an unexpected place? (Background on this error at: https://sqlalche.me/e/20/xd2s)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/ashwin/Desktop/algo-trading-app/backend/app/backtesting/runner.py", line 87, in run_backtest
    if backtest.started_at:
       ^^^^^^^^^^^^^^^^^^^
  File "/Users/ashwin/.pyenv/versions/3.12.1/lib/python3.12/site-packages/sqlalchemy/orm/attributes.py", line 569, in __get__
    return self.impl.get(state, dict_)  # type: ignore[no-any-return]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ashwin/.pyenv/versions/3.12.1/lib/python3.12/site-packages/sqlalchemy/orm/attributes.py", line 1096, in get
    value = self._fire_loader_callables(state, key, passive)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ashwin/.pyenv/versions/3.12.1/lib/python3.12/site-packages/sqlalchemy/orm/attributes.py", line 1126, in _fire_loader_callables
    return state._load_expired(state, passive)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ashwin/.pyenv/versions/3.12.1/lib/python3.12/site-packages/sqlalchemy/orm/state.py", line 803, in _load_expired
    self.manager.expired_attribute_loader(self, toload, passive)
  File "/Users/ashwin/.pyenv/versions/3.12.1/lib/python3.12/site-packages/sqlalchemy/orm/loading.py", line 1674, in load_scalar_attributes
    result = load_on_ident(
             ^^^^^^^^^^^^^^
  File "/Users/ashwin/.pyenv/versions/3.12.1/lib/python3.12/site-packages/sqlalchemy/orm/loading.py", line 510, in load_on_ident
    return load_on_pk_identity(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/ashwin/.pyenv/versions/3.12.1/lib/python3.12/site-packages/sqlalchemy/orm/loading.py", line 695, in load_on_pk_identity
    session.execute(
  File "/Users/ashwin/.pyenv/versions/3.12.1/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2351, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ashwin/.pyenv/versions/3.12.1/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2228, in _execute_internal
    ) = compile_state_cls.orm_pre_session_exec(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ashwin/.pyenv/versions/3.12.1/lib/python3.12/site-packages/sqlalchemy/orm/context.py", line 577, in orm_pre_session_exec
    session._autoflush()
  File "/Users/ashwin/.pyenv/versions/3.12.1/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 3040, in _autoflush
    self.flush()
  File "/Users/ashwin/.pyenv/versions/3.12.1/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/Users/ashwin/.pyenv/versions/3.12.1/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
  File "/Users/ashwin/.pyenv/versions/3.12.1/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 228, in __exit__
    raise value.with_traceback(traceback)
  File "/Users/ashwin/.pyenv/versions/3.12.1/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4467, in _flush
    transaction.rollback(_capture_exception=True)
  File "<string>", line 2, in rollback
  File "/Users/ashwin/.pyenv/versions/3.12.1/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/Users/ashwin/.pyenv/versions/3.12.1/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1393, in rollback
    raise rollback_err[1].with_traceback(rollback_err[2])
  File "/Users/ashwin/.pyenv/versions/3.12.1/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1358, in rollback
    t[1].rollback()
  File "/Users/ashwin/.pyenv/versions/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2611, in rollback
    self._do_rollback()
  File "/Users/ashwin/.pyenv/versions/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2730, in _do_rollback
    self._close_impl(try_deactivate=True)
  File "/Users/ashwin/.pyenv/versions/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2713, in _close_impl
    self._connection_rollback_impl()
  File "/Users/ashwin/.pyenv/versions/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2705, in _connection_rollback_impl
    self.connection._rollback_impl()
  File "/Users/ashwin/.pyenv/versions/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1130, in _rollback_impl
    self._handle_dbapi_exception(e, None, None, None, None)
  File "/Users/ashwin/.pyenv/versions/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2358, in _handle_dbapi_exception
    raise exc_info[1].with_traceback(exc_info[2])
  File "/Users/ashwin/.pyenv/versions/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1128, in _rollback_impl
    self.engine.dialect.do_rollback(self.connection)
  File "/Users/ashwin/.pyenv/versions/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 711, in do_rollback
    dbapi_connection.rollback()
  File "/Users/ashwin/.pyenv/versions/3.12.1/lib/python3.12/site-packages/sqlalchemy/dialects/sqlite/aiosqlite.py", line 307, in rollback
    self._handle_exception(error)
  File "/Users/ashwin/.pyenv/versions/3.12.1/lib/python3.12/site-packages/sqlalchemy/dialects/sqlite/aiosqlite.py", line 340, in _handle_exception
    raise error
  File "/Users/ashwin/.pyenv/versions/3.12.1/lib/python3.12/site-packages/sqlalchemy/dialects/sqlite/aiosqlite.py", line 305, in rollback
    self.await_(self._connection.rollback())
  File "/Users/ashwin/.pyenv/versions/3.12.1/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 123, in await_only
    raise exc.MissingGreenlet(
sqlalchemy.exc.MissingGreenlet: greenlet_spawn has not been called; can't call await_only() here. Was IO attempted in an unexpected place? (Background on this error at: https://sqlalche.me/e/20/xd2s)
=============================== warnings summary ===============================
backend/app/schemas/user.py:42
  /Users/ashwin/Desktop/algo-trading-app/backend/app/schemas/user.py:42: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    class UserResponse(UserBase):

backend/app/schemas/strategy.py:39
  /Users/ashwin/Desktop/algo-trading-app/backend/app/schemas/strategy.py:39: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    class StrategyResponse(StrategyBase):

backend/app/schemas/strategy.py:69
  /Users/ashwin/Desktop/algo-trading-app/backend/app/schemas/strategy.py:69: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    class StrategyTickerResponse(StrategyTickerBase):

backend/app/schemas/strategy.py:95
  /Users/ashwin/Desktop/algo-trading-app/backend/app/schemas/strategy.py:95: PydanticDeprecatedSince20: `min_items` is deprecated and will be removed, use `min_length` instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    tickers: List[str] = Field(

backend/app/schemas/trade.py:31
  /Users/ashwin/Desktop/algo-trading-app/backend/app/schemas/trade.py:31: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    class TradeResponse(TradeBase):

backend/app/schemas/trade.py:55
  /Users/ashwin/Desktop/algo-trading-app/backend/app/schemas/trade.py:55: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    class PositionResponse(PositionBase):

../../.pyenv/versions/3.12.1/lib/python3.12/site-packages/websockets/legacy/__init__.py:6
  /Users/ashwin/.pyenv/versions/3.12.1/lib/python3.12/site-packages/websockets/legacy/__init__.py:6: DeprecationWarning: websockets.legacy is deprecated; see https://websockets.readthedocs.io/en/stable/howto/upgrade.html for upgrade instructions
    warnings.warn(  # deprecated in 14.0 - 2024-11-09

backend/app/schemas/risk_rule.py:40
  /Users/ashwin/Desktop/algo-trading-app/backend/app/schemas/risk_rule.py:40: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    class RiskRuleResponse(RiskRuleBase):

backend/app/schemas/order.py:32
  /Users/ashwin/Desktop/algo-trading-app/backend/app/schemas/order.py:32: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    class OrderResponse(OrderBase):

backend/app/schemas/api_key.py:39
  /Users/ashwin/Desktop/algo-trading-app/backend/app/schemas/api_key.py:39: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    class ApiKeyResponse(ApiKeyBase):

backend/app/schemas/api_key.py:81
  /Users/ashwin/Desktop/algo-trading-app/backend/app/schemas/api_key.py:81: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    class ApiKeyAuditLogResponse(BaseModel):

backend/app/schemas/notification.py:32
  /Users/ashwin/Desktop/algo-trading-app/backend/app/schemas/notification.py:32: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    class NotificationResponse(NotificationBase):

backend/app/schemas/notification.py:83
  /Users/ashwin/Desktop/algo-trading-app/backend/app/schemas/notification.py:83: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    class NotificationPreferenceResponse(NotificationPreferenceBase):

backend/app/schemas/optimizer.py:12
  /Users/ashwin/Desktop/algo-trading-app/backend/app/schemas/optimizer.py:12: PydanticDeprecatedSince20: `min_items` is deprecated and will be removed, use `min_length` instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    symbols: List[str] = Field(

backend/app/schemas/optimizer.py:12
  /Users/ashwin/Desktop/algo-trading-app/backend/app/schemas/optimizer.py:12: PydanticDeprecatedSince20: `max_items` is deprecated and will be removed, use `max_length` instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    symbols: List[str] = Field(

backend/app/schemas/optimizer.py:37
  /Users/ashwin/Desktop/algo-trading-app/backend/app/schemas/optimizer.py:37: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    class StrategyPerformanceSchema(BaseModel):

backend/app/schemas/optimizer.py:56
  /Users/ashwin/Desktop/algo-trading-app/backend/app/schemas/optimizer.py:56: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    class OptimizationResultSchema(BaseModel):

backend/app/schemas/portfolio.py:40
  /Users/ashwin/Desktop/algo-trading-app/backend/app/schemas/portfolio.py:40: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    class PerformanceMetricsResponse(BaseModel):

backend/app/schemas/portfolio.py:102
  /Users/ashwin/Desktop/algo-trading-app/backend/app/schemas/portfolio.py:102: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    class TaxLotResponse(BaseModel):

backend/app/schemas/watchlist.py:27
  /Users/ashwin/Desktop/algo-trading-app/backend/app/schemas/watchlist.py:27: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    class WatchlistItemResponse(BaseModel):

backend/app/schemas/watchlist.py:44
  /Users/ashwin/Desktop/algo-trading-app/backend/app/schemas/watchlist.py:44: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    class WatchlistResponse(BaseModel):

backend/app/schemas/watchlist.py:74
  /Users/ashwin/Desktop/algo-trading-app/backend/app/schemas/watchlist.py:74: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    class PriceAlertResponse(BaseModel):

tests/test_backtesting_e2e.py::test_backtest_e2e_flow
  sys:1: SAWarning: transaction already deassociated from connection

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED backend/tests/test_backtesting_e2e.py::test_backtest_e2e_flow - Assert...
======================== 1 failed, 23 warnings in 0.76s ========================
